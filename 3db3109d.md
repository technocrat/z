---
date: 2021-07-14T23:29
---

# interpolation

[[[R]]]


``` r
# interpolate.R
# method for linear interpolation of missing values between two 
# non-consequtive years
# author: Richard Careaga
# Date: 2021-07-15

suppressPackageStartupMessages({
  library(tsibble)
})

# data w/o interpolation
a <- data.frame(
  year =c(1990,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2028,2040),
  elec =c(21904,11828,8027,7650,7582,9565,8745,8767,7579,6066,4212,4212,0,0),
  gas =c(21967, 11862, 10670,10851,10291,9070,9668,8600,8673,8389,9303,9303, 4393,0),
  water=c( 546,295,313,245,320,249,255,262,211,246,196,196,109,0),
  waste=c(1581,854,582,614,700,434,721,163,178,844,740,740,316,0))

# Ayla's data with interpolation

qa <- data.frame(
  year =
    c(1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023, 2024, 2025, 2026, 2027, 2028, 2029, 2030, 2031, 2032, 2033, 2034, 2035, 2036, 2037, 2038, 2039, 2040),
  elec =
    c(21904, 21400, 20896, 20393, 19889, 19385, 18881, 18377, 17874, 17370, 16866, 16362, 15858, 15355, 14851, 14347, 13843, 13339, 12836, 12332, 11828, 8027, 7650, 7582, 9565, 8745, 8767, 7579, 6066, 4212, 4212, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0),
  gas =
    c(21967, 21462, 20957, 20451, 19946, 19441, 18936, 18430, 17925, 17420, 16915, 16409, 15904, 15399, 14894, 14388, 13883, 13378, 12873, 12367, 11862, 10670, 10851, 10291, 9070, 9668, 8600, 8673, 8389, 9303, 9303, 8689, 8076, 7462, 6848, 6234, 5621, 5007, 4393, 4027, 3661, 3295, 2929, 2563, 2197, 1830, 1464, 1098, 732, 366, 0),
  water =
    c(546, 533, 521, 508, 496, 483, 471, 458, 446, 433, 421, 408, 395, 383, 370, 358, 345, 333, 320, 308, 295, 313, 245, 320, 249, 255, 262, 211, 246, 196, 196, 185, 174, 163, 153, 142, 131, 120, 109, 100, 91, 82, 73, 64, 55, 45, 36, 27, 18, 9, 0),
  waste =
    c(1581, 1545, 1508, 1472, 1436, 1399, 1363, 1327, 1290, 1254, 1218, 1181, 1145, 1108, 1072, 1036, 999, 963, 927, 890, 854, 582, 614, 700, 434, 721, 163, 178, 844, 740, 740, 687, 634, 581, 528, 475, 422, 369, 316, 290, 263, 237, 211, 184, 158, 132, 105, 79, 53, 26, 0))

b <- as_tsibble(a, index = year)

# first interpolation 1991-2009
# take years 1990 and 2010
interp1 <- b[1:2,]
# find difference to be spread
decline1 <- interp1[2,] - interp1[1,]
# divide into equal increments (not meaningful for year)
I <- decline1/20
# create receiver matrix
M <- I
# populate receiver matrix with the annual decline
for(i in 1:19) M[i,] = I
# prepend data for 1990
M <- rbind(b[1,],M)
# calculate cumulative reduction
M <- apply(M, 2, cumsum)
# set years
M[,1] <- 1990:2009
# result
M
#>       year    elec      gas  water   waste
#>  [1,] 1990 21904.0 21967.00 546.00 1581.00
#>  [2,] 1991 21400.2 21461.75 533.45 1544.65
#>  [3,] 1992 20896.4 20956.50 520.90 1508.30
#>  [4,] 1993 20392.6 20451.25 508.35 1471.95
#>  [5,] 1994 19888.8 19946.00 495.80 1435.60
#>  [6,] 1995 19385.0 19440.75 483.25 1399.25
#>  [7,] 1996 18881.2 18935.50 470.70 1362.90
#>  [8,] 1997 18377.4 18430.25 458.15 1326.55
#>  [9,] 1998 17873.6 17925.00 445.60 1290.20
#> [10,] 1999 17369.8 17419.75 433.05 1253.85
#> [11,] 2000 16866.0 16914.50 420.50 1217.50
#> [12,] 2001 16362.2 16409.25 407.95 1181.15
#> [13,] 2002 15858.4 15904.00 395.40 1144.80
#> [14,] 2003 15354.6 15398.75 382.85 1108.45
#> [15,] 2004 14850.8 14893.50 370.30 1072.10
#> [16,] 2005 14347.0 14388.25 357.75 1035.75
#> [17,] 2006 13843.2 13883.00 345.20  999.40
#> [18,] 2007 13339.4 13377.75 332.65  963.05
#> [19,] 2008 12835.6 12872.50 320.10  926.70
#> [20,] 2009 12331.8 12367.25 307.55  890.35
# rounding errors only compared to Ayla's data
M - qa[1:20,]
#>    year elec   gas water waste
#> 1     0  0.0  0.00  0.00  0.00
#> 2     0  0.2 -0.25  0.45 -0.35
#> 3     0  0.4 -0.50 -0.10  0.30
#> 4     0 -0.4  0.25  0.35 -0.05
#> 5     0 -0.2  0.00 -0.20 -0.40
#> 6     0  0.0 -0.25  0.25  0.25
#> 7     0  0.2 -0.50 -0.30 -0.10
#> 8     0  0.4  0.25  0.15 -0.45
#> 9     0 -0.4  0.00 -0.40  0.20
#> 10    0 -0.2 -0.25  0.05 -0.15
#> 11    0  0.0 -0.50 -0.50 -0.50
#> 12    0  0.2  0.25 -0.05  0.15
#> 13    0  0.4  0.00  0.40 -0.20
#> 14    0 -0.4 -0.25 -0.15  0.45
#> 15    0 -0.2 -0.50  0.30  0.10
#> 16    0  0.0  0.25 -0.25 -0.25
#> 17    0  0.2  0.00  0.20  0.40
#> 18    0  0.4 -0.25 -0.35  0.05
#> 19    0 -0.4 -0.50  0.10 -0.30
#> 20    0 -0.2  0.25 -0.45  0.35
```
