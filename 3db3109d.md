---
date: 2021-07-14T23:29
---

# interpolation

[[[R]]]


``` r
suppressPackageStartupMessages({
  library(fpp3)
})

# TRIM 2028 and 2040
a <- data.frame(
  year =c(1990,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020),
  elec =c(17269,11828,8027,7650,7582,9565,8745,8767,7579,6066,4212,4212))

annual_decline <- (a[2,2] - a[1,2]) / 19.5
  
b <- as_tsibble(a, index = year)
 
has_gaps(b)
#> # A tibble: 1 x 1
#>   .gaps
#>   <lgl>
#> 1 TRUE

b <- fill_gaps(b)
first <- b[1,1:2]
to_fill <- filter(b, is.na(elec))
to_fill[,2] <- annual_decline
to_fill <- add_row(first,to_fill)
to_fill <- to_fill %>% mutate(filled = cumsum(elec))
to_fill[,2] <- to_fill[,3]
to_fill <- to_fill[,1:2]

# trim out 1990
b <- b[-1,]

# reassemble with interpolated data

b <- add_row(to_fill,b)

ggplot(b,aes(year,elec)) + geom_point() + geom_line() + theme_minimal()
#> Warning: Removed 19 rows containing missing values (geom_point).
```

![](https://i.imgur.com/w9JhUgi.png)

``` r
b %>% select(elec) %>%
  model(ARIMA(elec)) %>%
  forecast(h = 8) %>% autoplot() + theme_minimal()
```

![](https://i.imgur.com/cOVQdK4.png)

``` r
b %>% select(elec) %>%
  model(ARIMA(elec)) %>%
  forecast(h = 20) %>% autoplot() + theme_minimal()
```

![](https://i.imgur.com/zexFexg.png)

``` r
library(forecast)
#> Registered S3 method overwritten by 'quantmod':
#>   method            from
#>   as.zoo.data.frame zoo
fit <- na.interp(b$elec)
fit
#> Time Series:
#> Start = 1 
#> End = 50 
#> Frequency = 1 
#>  [1] 17269.00 16989.97 16710.95 16431.92 16152.90 15873.87 15594.85 15315.82
#>  [9] 15036.79 14757.77 14478.74 14199.72 13920.69 13641.67 13362.64 13083.62
#> [17] 12804.59 12525.56 12246.54 11967.51 11960.54 11953.56 11946.59 11939.61
#> [25] 11932.63 11925.66 11918.68 11911.71 11904.73 11897.76 11890.78 11883.81
#> [33] 11876.83 11869.85 11862.88 11855.90 11848.93 11841.95 11834.98 11828.00
#> [41]  8027.00  7650.00  7582.00  9565.00  8745.00  8767.00  7579.00  6066.00
#> [49]  4212.00  4212.00
```
